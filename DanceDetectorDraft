import cv2 
import numpy as np
import matplotlib.pyplot as plt

cam = cv2.VideoCapture('Bees10.mov')

width = int(cam.get(cv2.CAP_PROP_FRAME_WIDTH))
height = int(cam.get(cv2.CAP_PROP_FRAME_HEIGHT))

delay_time = 40
prev_frame = None
while True:
    ret, frame = cam.read()

    # Operations on the frame
    gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)
    gray_blur = cv2.GaussianBlur(gray, (21,21), 0)
    
    # If first frame, set current frame as prev_frame
    if prev_frame is None:
        prev_frame = gray_blur
    current_frame = gray_blur
    
    frame_diff = cv2.absdiff(current_frame, prev_frame)
    thresh = cv2.threshold(frame_diff, 25, 255, cv2.THRESH_BINARY)[1]

    
    # Display the resulting frame
    cv2.imshow('frame', thresh)
    cv2.waitKey(delay_time)
    
    # q to quit
    if cv2.waitKey(delay_time) & 0xFF == ord('q'):
        break
    
    # Upon next loop, use frame as previous 
    prev_frame = current_frame
    
cam.release()
cv2.destroyAllWindows()
